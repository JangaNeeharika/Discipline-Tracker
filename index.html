<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discipline Tracker</title>

<style>
:root {
    --bg: #0f172a;
    --container: #1e293b;
    --text: #ffffff;
    --muted: #111827;
    --primary: #669aed;
    --primary-hover: #2563eb;
    --done: #1e8945;
}

body.light {
    --bg: #ffffff;
    --container: #ffffff;
    --text: #0d0d0d;
    --muted: #cbd5e1;
    --primary: #2563eb;
    --primary-hover: #1d4ed8;
    --done: #16a34a;
}

body {
    font-family: Arial, sans-serif;
    background: var(--bg);
    padding: 15px;
    color: var(--text);
}

.container {
    background: var(--container);
    padding: 20px;
    border-radius: 12px;
    max-width: 1200px;
    margin: auto;
}

/* Controls */
.controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 15px;
}

select, input, button {
    padding: 10px;
    border-radius: 6px;
    border: none;
    flex: 1;
    min-width: 120px;
}

select, input {
    background: var(--muted);
    color: var(--text);
}

button {
    background: var(--primary);
    color: white;
    cursor: pointer;
}

button:hover {
    background: var(--primary-hover);
}

/* Table */
.table-wrapper {
    overflow-x: auto;
}

table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 6px;
    margin-top: 10px;
    font-size: 12px;
    min-width: 700px;
}

th {
    background: var(--muted);
    padding: 5px;
    font-size: 10px;
}

tbody td:not(:first-child) {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    cursor: pointer;
}

.done {
    background: var(--done);
}

.not-done {
    background: var(--muted);
}

tbody td:first-child {
    border-radius: 8px;
    padding: 6px;
    background: var(--muted);
}

/* Report */
.report {
    margin-top: 30px;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 10px;
    text-align: center;
}

.report div {
    background: var(--muted);
    padding: 10px;
    border-radius: 10px;
}

/* Mobile */
@media (max-width: 768px) {
    select, input, button {
        width: 100%;
    }
}
</style>
</head>

<body>

<div class="container">

<h1 style="text-align:center;">Discipline Tracker</h1>

<div class="controls">
<select id="yearSelect"></select>
<select id="monthSelect"></select>
<input type="text" id="habitInput" placeholder="New habit">
<button type="button" id="addBtn">Add Habit</button>
<button type="button" onclick="toggleTheme()">Toggle Theme</button>
</div>

<div class="table-wrapper">
<table id="habitTable">
<thead>
<tr id="headerRow"><th>Habit</th></tr>
</thead>
<tbody></tbody>
</table>
</div>

<div class="report">
<div><h3>ðŸ”¥ Strong Days</h3><p id="strongDays">0</p></div>
<div><h3>âš  Weak Days</h3><p id="weakDays">0</p></div>
<div><h3>ðŸ“Š Completion</h3><p id="completionRate">0%</p></div>
</div>

</div>

<script>
let currentYear = new Date().getFullYear();
let currentMonth = new Date().getMonth();

let habits = JSON.parse(localStorage.getItem("habits")) || ["Wake Early","Exercise"];
let data = JSON.parse(localStorage.getItem("habitData")) || {};

const monthNames = ["January","February","March","April","May","June","July","August","September","October","November","December"];
const dayNames = ["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];

function daysInMonth(year, month){
    return new Date(year, month+1, 0).getDate();
}

function initializeData(){
    if(!data[currentYear]) data[currentYear]={};
    if(!data[currentYear][currentMonth]){
        data[currentYear][currentMonth] =
            habits.map(()=>Array(daysInMonth(currentYear,currentMonth)).fill(0));
    }
}

function saveData(){
    localStorage.setItem("habits",JSON.stringify(habits));
    localStorage.setItem("habitData",JSON.stringify(data));
}

function initializeSelectors(){
    const yearSelect = document.getElementById("yearSelect");
    const monthSelect = document.getElementById("monthSelect");

    yearSelect.innerHTML="";
    monthSelect.innerHTML="";

    for(let y=2024; y<=2030; y++){
        let option=document.createElement("option");
        option.value=y;
        option.textContent=y;
        if(y===currentYear) option.selected=true;
        yearSelect.appendChild(option);
    }

    monthNames.forEach((m,i)=>{
        let option=document.createElement("option");
        option.value=i;
        option.textContent=m;
        if(i===currentMonth) option.selected=true;
        monthSelect.appendChild(option);
    });

    yearSelect.addEventListener("change", ()=>{
        currentYear=parseInt(yearSelect.value);
        initializeData();
        renderTable();
    });

    monthSelect.addEventListener("change", ()=>{
        currentMonth=parseInt(monthSelect.value);
        initializeData();
        renderTable();
    });
}

function renderTable(){
    initializeData();

    const headerRow=document.getElementById("headerRow");
    const tbody=document.querySelector("#habitTable tbody");

    headerRow.innerHTML="<th>Habit</th>";
    tbody.innerHTML="";
    let totalDays=daysInMonth(currentYear,currentMonth);

    for(let d=1; d<=totalDays; d++){
        let th=document.createElement("th");
        let dateObj=new Date(currentYear,currentMonth,d);
        th.innerHTML=dayNames[dateObj.getDay()]+"<br>"+d;
        headerRow.appendChild(th);
    }

    habits.forEach((habit,r)=>{
        let row=document.createElement("tr");
        let habitCell=document.createElement("td");
        habitCell.textContent = habit;
        row.appendChild(habitCell);

        for(let c=0;c<totalDays;c++){
            let cell=document.createElement("td");
            cell.className=data[currentYear][currentMonth][r][c]?"done":"not-done";
            cell.addEventListener("click",()=>{
                data[currentYear][currentMonth][r][c]^=1;
                saveData();
                renderTable();
            });
            row.appendChild(cell);
        }
        tbody.appendChild(row);
    });

    updateReport();
}

function addHabit(){
    let input=document.getElementById("habitInput");
    let value=input.value.trim();
    if(!value) return;

    initializeData();

    habits.push(value);
    data[currentYear][currentMonth].push(
        Array(daysInMonth(currentYear,currentMonth)).fill(0)
    );

    input.value="";
    saveData();
    renderTable();
}

document.getElementById("addBtn").addEventListener("click", addHabit);

document.getElementById("habitInput").addEventListener("keypress", function(e){
    if(e.key==="Enter"){
        addHabit();
    }
});

function toggleTheme(){
    document.body.classList.toggle("light");
}

function updateReport(){
    let strong=0,total=0;

    habits.forEach((_,r)=>{
        data[currentYear][currentMonth][r].forEach(val=>{
            total++;
            if(val) strong++;
        });
    });

    document.getElementById("strongDays").textContent=strong;
    document.getElementById("weakDays").textContent=total-strong;
    document.getElementById("completionRate").textContent=
        total? Math.round((strong/total)*100)+"%" : "0%";
}

initializeSelectors();
initializeData();
renderTable();
</script>

</body>
</html>
